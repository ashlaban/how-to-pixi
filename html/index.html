<html>
<head>
    <title>7-HexColors</title>

    <link rel="stylesheet" type="text/css" href="../lib/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../css/7-HexColors.css">

    <script src="../lib/pixi.js"></script>
    <script src="../lib/fpsmeter.min.js"></script>
    <script src="../lib/progressbar.js"></script>

    <script src="../js/HexUtil.js"></script>
    <script src="../js/HexMath.js"></script>
    <script src="../js/HexColor.js"></script>
    <script src="../js/HexConfiguration.js"></script>
    <script src="../js/HexCell.js"></script>
    <script src="../js/HexGrid.js"></script>
    <script src="../js/HexGame.js"></script>
</head>

<body>
    <div id='main' class='flex-container vertical'>
    <div id='content-wrapper'>
        <div class='well2 top'>
            <h1>7-HexColors</h1>
        </div>
        <div id='content' class='flex-container vertical'>
            <div id="canvas-wrapper" class='well2 middle'></div>
            <div id='side-panel' class='flex-container vertical well2 middle'>
                <div id='color-select' class='flex-container btn-group'>
                    <input type='button' class='rule btn' value='1'>
                    <input type='button' class='rule btn' value='2'>
                    <input type='button' class='rule btn' value='3'>
                    <input type='button' class='rule btn' value='4'>
                    <input type='button' class='rule btn' value='5'>
                    <input type='button' class='rule btn' value='6'>
                    <input type='button' class='rule btn' value='7'>
                </div>
            </div>
        </div>
        <div class='well2 bottom'>
            <h2>Explanation</h2>
            This is the old Infrogrames game 7-colors ported to the interblaggosphere. Originally created by Dmitry Pashkov from the Russian company Gamos.

            Select a color to grow your territory. Beat the computer, first to cover more than 50% of the screen wins!

            <h3>In-depth</h3>
            More to come.

        </div>
    </div>
    </div>
    <script>

    var conf = new HexConfiguration.Configuration();
    conf.fill();
    conf.center();

    // Set up the PIXI renderer
    var renderer = new PIXI.WebGLRenderer   (
                                                conf.view.size.w,
                                                conf.view.size.h, 
                                                {
                                                    transparent : true,
                                                    antialias   : true,
                                                    resolution  : window.devicePixelRatio
                                                }
                                            );
    document.getElementById('canvas-wrapper').appendChild(renderer.view);
    renderer.view.style.width  = conf.view.size.w;
    renderer.view.style.height = conf.view.size.h;

    var game = new HexGame.Game(conf, renderer);

    // Kick-start the rendering process
    animate();

    function animate() {
        requestAnimationFrame(animate);
        if (game.isStarted) { game.step(conf.game.stepsPerSecond); }
    }

    var ruleButtons = [].slice.call(document.getElementsByClassName('rule'));
    ruleButtons.forEach(function(button, i) {
        var buttonColor = game.conf.game.colorPalette[i];
        button.style.backgroundColor = '#' + buttonColor.toString(16);
        button.onclick = function () {
            game.flood(game.sourceCell, buttonColor);
        };
    });

    renderer.view.onmouseup   = game.onmouseup
    document.onkeypress = function(ev){
        var character =  String.fromCharCode(ev.which);
        switch (character) {
            case '1': ruleButtons[0].click(); break;
            case '2': ruleButtons[1].click(); break;
            case '3': ruleButtons[2].click(); break;
            case '4': ruleButtons[3].click(); break;
            case '5': ruleButtons[4].click(); break;
            case '6': ruleButtons[5].click(); break;
            case '7': ruleButtons[6].click(); break;
            default: break;
        }
    }

    </script>
    </body>
</html>